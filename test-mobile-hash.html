<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Mobile Hash Detection</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #001a33 0%, #003366 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        h1 {
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        h2 {
            color: #00FF00;
            font-size: 1.2em;
            margin-top: 0;
        }
        .value {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            margin: 5px 0;
        }
        .test-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .test-link {
            background: #FFD700;
            color: #001a33;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        .test-link:hover {
            transform: scale(1.05);
        }
        .true {
            color: #00FF00;
        }
        .false {
            color: #FF6666;
        }
        button {
            background: #00FF00;
            color: #001a33;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
        }
        button:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Ocean King 3 - Mobile Test Mode Detection</h1>
        
        <div class="test-section">
            <h2>Current URL Information:</h2>
            <p>Full URL: <span class="value" id="href"></span></p>
            <p>Hash: <span class="value" id="hash"></span></p>
            <p>Search: <span class="value" id="search"></span></p>
        </div>

        <div class="test-section">
            <h2>Test Mode Detection:</h2>
            <p>Hash contains 'testMobile': <span class="value" id="hashTest"></span></p>
            <p>Query param 'testMobile': <span class="value" id="queryTest"></span></p>
            <p>LocalStorage 'testMobile': <span class="value" id="localTest"></span></p>
            <p>Window.testMobile: <span class="value" id="windowTest"></span></p>
            <p><strong>Test Mode Active: <span class="value" id="testMode"></span></strong></p>
        </div>

        <div class="test-section">
            <h2>Device Information:</h2>
            <p>User Agent: <span class="value" id="userAgent"></span></p>
            <p>Is Mobile (by UA): <span class="value" id="isMobileUA"></span></p>
            <p>Is Mobile (by width): <span class="value" id="isMobileWidth"></span></p>
            <p>Window Size: <span class="value" id="windowSize"></span></p>
            <p>Is Portrait: <span class="value" id="isPortrait"></span></p>
        </div>

        <div class="test-section">
            <h2>Test Links:</h2>
            <div class="test-links">
                <a href="#" class="test-link">No Hash</a>
                <a href="#testMobile" class="test-link">With #testMobile</a>
                <a href="?testMobile=true" class="test-link">With Query Param</a>
                <a href="#testMobile?other=param" class="test-link">Complex Hash</a>
            </div>
            
            <button onclick="toggleLocalStorage()">Toggle LocalStorage testMobile</button>
            <button onclick="toggleWindowTestMobile()">Toggle Window.testMobile</button>
            <button onclick="clearAll()">Clear All Test Modes</button>
        </div>

        <div class="test-section">
            <h2>Expected Behavior:</h2>
            <p id="expectedBehavior"></p>
        </div>
    </div>

    <script>
        function updateInfo() {
            // URL Information
            document.getElementById('href').textContent = window.location.href;
            document.getElementById('hash').textContent = window.location.hash || '(empty)';
            document.getElementById('search').textContent = window.location.search || '(empty)';
            
            // Test Mode Detection
            const urlParams = new URLSearchParams(window.location.search);
            const hashValue = window.location.hash;
            const hashContainsTestMobile = hashValue === '#testMobile' || hashValue.includes('testMobile');
            const queryParamTest = urlParams.get('testMobile') === 'true';
            const localStorageTest = window.localStorage.getItem('testMobile') === 'true';
            const windowTest = window.testMobile === true;
            
            const testMobile = queryParamTest || hashContainsTestMobile || localStorageTest || windowTest;
            
            document.getElementById('hashTest').textContent = hashContainsTestMobile;
            document.getElementById('hashTest').className = 'value ' + hashContainsTestMobile;
            
            document.getElementById('queryTest').textContent = queryParamTest;
            document.getElementById('queryTest').className = 'value ' + queryParamTest;
            
            document.getElementById('localTest').textContent = localStorageTest;
            document.getElementById('localTest').className = 'value ' + localStorageTest;
            
            document.getElementById('windowTest').textContent = windowTest;
            document.getElementById('windowTest').className = 'value ' + windowTest;
            
            document.getElementById('testMode').textContent = testMobile;
            document.getElementById('testMode').className = 'value ' + testMobile;
            
            // Device Information
            const isMobileUA = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            const isMobileWidth = window.innerWidth <= 768;
            const isPortrait = window.innerHeight > window.innerWidth;
            
            document.getElementById('userAgent').textContent = navigator.userAgent.substring(0, 50) + '...';
            document.getElementById('isMobileUA').textContent = isMobileUA;
            document.getElementById('isMobileUA').className = 'value ' + isMobileUA;
            
            document.getElementById('isMobileWidth').textContent = isMobileWidth;
            document.getElementById('isMobileWidth').className = 'value ' + isMobileWidth;
            
            document.getElementById('windowSize').textContent = window.innerWidth + ' x ' + window.innerHeight;
            
            document.getElementById('isPortrait').textContent = isPortrait;
            document.getElementById('isPortrait').className = 'value ' + isPortrait;
            
            // Expected Behavior
            const isMobile = isMobileUA || isMobileWidth;
            let expectedBehavior = '';
            
            if (!isMobile && !testMobile) {
                expectedBehavior = 'üñ•Ô∏è Desktop Mode: Should auto-start game after brief overlay';
            } else if (testMobile) {
                expectedBehavior = 'üß™ Test Mode Active: Should show "Swipe Up to Begin" prompt with animated arrow';
            } else if (isPortrait) {
                expectedBehavior = 'üì± Mobile Portrait: Should show rotation prompt';
            } else {
                expectedBehavior = 'üì± Mobile Landscape: Should show "Swipe Up to Begin" prompt';
            }
            
            document.getElementById('expectedBehavior').textContent = expectedBehavior;
        }
        
        function toggleLocalStorage() {
            const current = window.localStorage.getItem('testMobile') === 'true';
            window.localStorage.setItem('testMobile', (!current).toString());
            updateInfo();
        }
        
        function toggleWindowTestMobile() {
            window.testMobile = !window.testMobile;
            updateInfo();
        }
        
        function clearAll() {
            window.localStorage.removeItem('testMobile');
            delete window.testMobile;
            window.location.href = window.location.pathname;
        }
        
        // Update on load
        updateInfo();
        
        // Update on hash change
        window.addEventListener('hashchange', updateInfo);
        
        // Also check after a small delay to catch any timing issues
        setTimeout(updateInfo, 100);
        setTimeout(updateInfo, 500);
    </script>
</body>
</html>